  0%|          | 0/1000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/ordabayev/anaconda3/envs/pyro/lib/python3.7/site-packages/pyro/poutine/trace_messenger.py", line 147, in __call__
    ret = self.fn(*args, **kwargs)
  File "/home/ordabayev/anaconda3/envs/pyro/lib/python3.7/site-packages/pyro/poutine/messenger.py", line 10, in _context_wrap
    return fn(*args, **kwargs)
  File "/home/ordabayev/Documents/BayesianImage/cosmos/models/Modelv5.py", line 229, in guide
    pyro.sample("junk_width", dist.Gamma(jw_loc[batch_idx] * jw_beta * size[batch_idx], jw_beta * size[batch_idx]))
RuntimeError: The size of tensor a (16) must match the size of tensor b (331) at non-singleton dimension 0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/home/ordabayev/Documents/BayesianImage/cosmos/models/Modelv5.py", line 248, in epoch
    epoch_loss = self.svi.step()
  File "/home/ordabayev/anaconda3/envs/pyro/lib/python3.7/site-packages/pyro/infer/svi.py", line 100, in step
    loss = self.loss_and_grads(self.model, self.guide, *args, **kwargs)
  File "/home/ordabayev/anaconda3/envs/pyro/lib/python3.7/site-packages/pyro/infer/traceenum_elbo.py", line 376, in loss_and_grads
    for model_trace, guide_trace in self._get_traces(model, guide, *args, **kwargs):
  File "/home/ordabayev/anaconda3/envs/pyro/lib/python3.7/site-packages/pyro/infer/traceenum_elbo.py", line 299, in _get_traces
    self._guess_max_plate_nesting(model, guide, *args, **kwargs)
  File "/home/ordabayev/anaconda3/envs/pyro/lib/python3.7/site-packages/pyro/infer/elbo.py", line 95, in _guess_max_plate_nesting
    guide_trace = poutine.trace(guide).get_trace(*args, **kwargs)
  File "/home/ordabayev/anaconda3/envs/pyro/lib/python3.7/site-packages/pyro/poutine/trace_messenger.py", line 169, in get_trace
    self(*args, **kwargs)
  File "/home/ordabayev/anaconda3/envs/pyro/lib/python3.7/site-packages/pyro/poutine/trace_messenger.py", line 153, in __call__
    traceback)
  File "/home/ordabayev/anaconda3/envs/pyro/lib/python3.7/site-packages/six.py", line 692, in reraise
    raise value.with_traceback(tb)
  File "/home/ordabayev/anaconda3/envs/pyro/lib/python3.7/site-packages/pyro/poutine/trace_messenger.py", line 147, in __call__
    ret = self.fn(*args, **kwargs)
  File "/home/ordabayev/anaconda3/envs/pyro/lib/python3.7/site-packages/pyro/poutine/messenger.py", line 10, in _context_wrap
    return fn(*args, **kwargs)
  File "/home/ordabayev/Documents/BayesianImage/cosmos/models/Modelv5.py", line 229, in guide
    pyro.sample("junk_width", dist.Gamma(jw_loc[batch_idx] * jw_beta * size[batch_idx], jw_beta * size[batch_idx]))
RuntimeError: The size of tensor a (16) must match the size of tensor b (331) at non-singleton dimension 0
        Trace Shapes:                    
         Param Sites:                    
             offset_v                    
               gain_v                    
     pi_concentration                 2  
junk_pi_concentration                 2  
   background_loc_loc                 1  
  background_loc_beta                 1  
  background_beta_loc                 1  
 background_beta_beta                 1  
       height_loc_loc                 1  
      height_loc_beta                 1  
      height_beta_loc                 1  
     height_beta_beta                 1  
        width_loc_loc                 1  
       width_loc_beta                 1  
       width_beta_loc                 1  
      width_beta_beta                 1  
                b_loc     331 862   1 1  
               b_beta                 1  
                h_loc                 1  
               h_beta     331 862   1 1  
                w_loc     331 862   1 1  
               w_beta                 1  
               x_mode     331 862   1 1  
                 size     331 862   1 1  
               y_mode     331 862   1 1  
               jh_loc                 1  
              jh_beta     331 862   1 1  
               jw_loc     331 862   1 1  
              jw_beta     331 862   1 1  
              jx_mode     331 862   1 1  
                jsize     331 862   1 1  
              jy_mode     331 862   1 1  
              z_probs 331 862   1   1 2  
              j_probs 331 862   1   1 2  
        Sample Sites:                    
          offset dist                 |  
                value                 |  
            gain dist                 |  
                value                 |  
         K_plate dist                 |  
                value               1 |  
         N_plate dist                 |  
                value              16 |  
         F_plate dist                 |  
                value             862 |  
              pi dist                 | 2
                value                 | 2
         junk_pi dist                 | 2
                value                 | 2
  background_loc dist               1 |  
                value               1 |  
 background_beta dist               1 |  
                value               1 |  
      height_loc dist               1 |  
                value               1 |  
     height_beta dist               1 |  
                value               1 |  
       width_loc dist               1 |  
                value               1 |  
      width_beta dist               1 |  
                value               1 |  
               z dist  16 862   1   1 |  
                value  16 862   1   1 |  
               j dist  16 862   1   1 |  
                value  16 862   1   1 |  
      background dist  16 862   1   1 |  
                value  16 862   1   1 |  
          height dist  16 862   1   1 |  
                value  16 862   1   1 |  
           width dist  16 862   1   1 |  
                value  16 862   1   1 |  
              x0 dist  16 862   1   1 |  
                value  16 862   1   1 |  
              y0 dist  16 862   1   1 |  
                value  16 862   1   1 |  
     junk_height dist  16 862   1   1 |  
                value  16 862   1   1 |  

